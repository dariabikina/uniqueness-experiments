library(tidyverse)
library(lmerTest)
library(dplyr)
library(ordinal)
library(rcompanion)

setwd("/Users/dariabikina/Documents/Harvard/Experiment Uniqueness")
eng <- read.csv("eng_2.csv")
plot_plural_english_confidence_intervals <- eng %>% filter(Context == "exp3" | Context == "exp8") %>% ggplot(aes(x=Context, y=Rate)) + geom_boxplot(notch=FALSE) + scale_x_discrete(labels = c('Maximality met','Maximality not met')) + labs(title = "Acceptability rates of English definite plural NPs: maximality vs. non-maximality", subtitle = "Mean rates and 95% confidence intervals") +xlab(NULL)
only_eng_plurals <- eng %>% filter(Context == "exp3" | Context == "exp8")  
model_eng_plurals = lmer(Rate ~ Context + (1|Participant), data = only_eng_plurals)
only_eng_plurals$Rate <- only_eng_plurals$Rate - 1
only_eng_plurals$Rate <- as.factor(only_eng_plurals$Rate)
plot_eng_percentage_plurals <- ggplot(only_eng_plurals, aes(Context, fill = forcats::fct_rev(Rate))) + geom_bar(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + labs(title = "English plural NPs: maximality vs. non-maximality", subtitle = "Percentage distribution of ratings", fill = "Rate") + scale_x_discrete(labels = c("Maximality met", "Maximality not met")) + xlab(NULL) + ylab(NULL)
rus <- read.csv("rus_2.csv")
only_rus_plurals <- rus %>% filter(Context == "exp3" | Context == "exp8")
model_rus_plurals = lmer(Rate ~ Context + (1|Participant), data = only_rus_plurals)
plot_plurals_rus_confidence_interval <- only_rus_plurals %>% ggplot(aes(x=Context, y=Rate)) + geom_boxplot(notch=FALSE) + scale_x_discrete(labels = c("Maximality met", "Maximality not met")) + labs(title = "Acceptability rates of Russian bare plural NPs: maximality vs. non-maximality", subtitle = "Mean rates and 95% confidence intervals") +xlab(NULL)
only_rus_plurals$Rate <- as.factor(only_rus_plurals$Rate)
plot_rus_percentage_plurals <- ggplot(only_rus_plurals, aes(Context, fill = forcats::fct_rev(Rate))) + geom_bar(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + labs(title = "Russian plural NPs: maximality vs. non-maximality", subtitle = "Percentage distribution of ratings", fill = "Rate") + scale_x_discrete(labels = c("Maximality met", "Maximality not met")) + xlab(NULL) + ylab(NULL)
rus_exp1vs2 <- rus %>% filter(Context == "exp1" | Context == "exp2")
model_rus_exp1vs2 <- lmer(Rate ~ Context + (1|Participant), data = rus_exp1vs2)
plot_rus_sg_uniqueness_confidence <- rus_exp1vs2 %>% ggplot(aes(x=Context, y=Rate)) + geom_boxplot(notch=FALSE) + scale_x_discrete(labels = c('Uniqueness met', 'Uniqueness not met')) + labs(title = "Acceptability rate of Russian bare singular NPs: uniqueness vs. non-uniqueness", subtitle = "Mean rates and 95% confidence intervals") + xlab(NULL)
rus_exp1vs2$Rate <- as.factor(rus_exp1vs2$Rate)
plot_rus_sg_uniqueness <- rus_exp1vs2 %>% ggplot(aes(Context, fill= forcats::fct_rev(Rate))) + geom_bar(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + labs(title = "Russian singular NPs: uniqueness vs. non-uniqueness", subtitle = "Percentage distribution of ratings", fill="Rate")+scale_x_discrete(labels = c("Uniqueness met", "Uniqueness not met")) + xlab(NULL) + ylab(NULL)
eng_exp1vs2 <- eng %>% filter(Context == "exp1" | Context == "exp2")
plot_eng_sg_uniqueness_confidence <- eng_exp1vs2 %>% ggplot(aes(x=Context, y=Rate)) + geom_boxplot(notch=FALSE) + scale_x_discrete(labels = c('Uniqueness met', 'Uniqueness not met')) + labs(title = "Acceptability rate of English definite singular NPs: uniqueness vs. non-uniqueness", subtitle = "Mean rates and 95% confidence intervals") + xlab(NULL)
model_eng_exp1vs2 <- lmer(Rate ~ Context + (1|Participant), data = eng_exp1vs2)
eng_exp1vs2$Rate <- as.factor(eng_exp1vs2$Rate)
plot_eng_sg_uniqueness <- eng_exp1vs2 %>% ggplot(aes(Context, fill= forcats::fct_rev(Rate))) + geom_bar(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + labs(title = "English definite singular NPs: uniqueness vs. non-uniqueness", subtitle = "Percentage distribution of ratings", fill="Rate")+scale_x_discrete(labels = c("Uniqueness met", "Uniqueness not met")) + xlab(NULL) + ylab(NULL)

eng_zoom <- read.csv("English_Zooming_preprocessed.csv")
model_zoom_eng <- lmer(rate ~ zooming + (1|participant), data = eng_zoom)
plot_eng_zoom_confidence <- eng_zoom %>% ggplot(aes(x=zooming, y=rate)) +geom_boxplot() + xlab(NULL) + ylab("Rate") + labs(title = "Acceptability rate of English singular plurals with non-unique individuals", subtitle = "The zooming-in effect") + scale_x_discrete(labels = c("The girl is not centered", "The girl is centered"))
eng_zoom$rate <- as.factor(eng_zoom$rate)
plot_eng_zoom <- eng_zoom %>% ggplot(aes(zooming, fill = forcats::fct_rev(rate))) + geom_bar(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + labs(title = "The absence of the zooming-in effect in English", fill = "Rate") + xlab(NULL) + ylab(NULL) + scale_x_discrete(labels = c("The girl is not centered", "The girl is centered"))


rus_zoom <- read.csv("Russian_Zooming_preprocessed.csv")
colnames(rus_zoom) <- c("Participant", "Rate", "Zooming", "Language")
rus_zoom <- rus_zoom[,1:4]
model_rus_zoom <- lmer(Rate ~ Zooming + (1|Participant), data = rus_zoom)
plot_rus_zoom_confidence <- rus_zoom %>% ggplot(aes(x=Zooming, y=Rate)) +geom_boxplot() + xlab(NULL) + labs(title = "Acceptability rates of singular NPs for non-unique induviduals", subtitle = "The zooming in effect") +  scale_x_discrete(labels = c("The girl is not centered", "The girl is centered")) 
rus_zoom$Rate <- as.factor(rus_zoom$Rate)
plot_rus_zoom <- rus_zoom %>% ggplot(aes(Zooming, fill = forcats::fct_rev(Rate))) + geom_bar(colour = "black", position = "fill") +scale_y_continuous(labels = scales:: percent) + labs(titile = "Russian singular NPs: the zooming in effect", subtitle = "Percentage distribution of the ratings", fill = "Rate") + xlab(NULL) +ylab(NULL) + scale_x_discrete(labels = c("The girl is not centered", "The girl is centered"))

